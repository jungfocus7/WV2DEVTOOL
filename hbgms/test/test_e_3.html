<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body style="background-color: black;">
  <svg xmlns="http://www.w3.org/2000/svg" width="400" height="400"
    style="background-color: rebeccapurple; cursor: pointer;" id="svgrt_1">
    <defs>
      <rect id="d_rc1" width="50" height="50" x="0" y="0"/>
      <clipPath id="d_cp1">
        <use href="#d_rc1"/>
      </clipPath>
      <!-- <g id="d_gr1">
        <use href="#d_rc1" fill="yellow"/>
        <text x="25" y="25" font-family="Arial" font-size="11" id="d_tx1"
          fill="blue" text-anchor="middle" font-weight="bolder"
          dominant-baseline="central" clip-path="url(#d_cp1)">xxxxxxx박종명xxxxxxx</text>
      </g> -->
    </defs>
  </svg>

  <script>
    /**
     * @param {SVGTransform} trsf
     * @param {number} rw (RealWidth)
     * @param {number} rh (RealHeight)
     * @param {number} aw (ApplyWidth)
     * @param {number} ah (ApplyHeight)
     */
    const fn_setSize = (trsf, rw, rh, aw, ah) => {
        const mat = trsf.matrix;
        mat.a = (aw / rw);
        mat.d = (ah / rh);
    };

    /**
     * @param {SVGTransform} trsf
     * @param {number} rw (RealWidth)
     * @param {number} rh (RealHeight)
     */
    const fn_getSize = (trsf, rw, rh) => {
        const mat = trsf.matrix;
        return {
            width: rw * mat.a,
            height: rh * mat.d,
        };
    };


    const _svgrt = document.getElementById('svgrt_1');
    // console.log(_svgrt);

    const _drc = _svgrt.getBoundingClientRect();
    // console.log(_drc);

    _svgrt.insertAdjacentHTML('beforeend', `
<g transform="scale(1.0 1.0)">
  <use href="#d_rc1" fill="red"/>
  <text x="25" y="25" font-family="Arial" font-size="11"
    fill="blue" text-anchor="middle" font-weight="bolder"
    dominant-baseline="central" clip-path="url(#d_cp1)">xxxxxxx박종명xxxxxxx</text>
</g>`.trim());
    _svgrt.insertAdjacentHTML('beforeend', `
<g transform="scale(1.0 1.0)">
  <use href="#d_rc1" fill="green"/>
  <text x="25" y="25" font-family="Arial" font-size="11"
    fill="blue" text-anchor="middle" font-weight="bolder"
    dominant-baseline="central" clip-path="url(#d_cp1)">xxxxxxx박종명xxxxxxx</text>
</g>`.trim());
    _svgrt.insertAdjacentHTML('beforeend', `
<g transform="scale(1.0 1.0),translate(10 10)">
  <use href="#d_rc1" fill="blue"/>
  <text x="25" y="25" font-family="Arial" font-size="11"
    fill="whitesmoke" text-anchor="middle" font-weight="bolder"
    dominant-baseline="central" clip-path="url(#d_cp1)">xxxxxxx박종명xxxxxxx</text>
</g>`.trim());

    const _ges = Array.from(_svgrt.children).filter((te) => {
      return te instanceof SVGGElement;
    });
    console.log(_ges, Array.isArray(_ges));


    fn_setSize(_ges[0].transform.baseVal.getItem(0), 50, 50, 300, 300);
    fn_setSize(_ges[1].transform.baseVal.getItem(0), 50, 50, 200, 200);
    fn_setSize(_ges[2].transform.baseVal.getItem(0), 50, 50, 100, 100);

    const _ge = _ges[2];

    const fn_test = () => {
      _ge.transform = null;
      _ge.transform.baseVal = null;
      // _ge.transform.baseVal.clear();
      console.log(_ge.transform.baseVal);
      // console.log(_ge.getAttribute('transform'));

    };

    window.addEventListener('mousemove', (me) => {
      let tx = me.clientX - _drc.left;
      let ty = me.clientY - _drc.top;
      if (tx < 0) tx = 0;
      if (ty < 0) ty = 0;

      // fn_setSize(_ge.transform.baseVal.getItem(0), 50, 50, tx, ty);
      _ge.setAttribute('transform', `scale(${tx/50} ${ty/50})`);
      // _ge.setAttribute('transform', `translate(${tx} ${ty})`);

      fn_test();
    });




  // console.log(_ges[1].toString());
  // console.log(_ges[0] instanceof SVGElement);

    // const _use = _svgrt.lastElementChild;
    // // console.log(_use);

    // const _drc = _svgrt.getBoundingClientRect();
    // // console.log(_drc);

    // const _trsf = _use.transform.baseVal.getItem(0);
    // // console.log(fn_getSize(_trsf, _drc.width, _drc.height));


    // const fn_test = () => {
    //   const _z1 = document.getElementById('d_tx1');
    //   _z1.textContent = 'xxxxxxx임헌진xxxxxxx';
    //   console.log(_z1.textContent);
    // };

    // window.addEventListener('mousemove', (me) => {
    //   let tx = me.clientX - _drc.left;
    //   let ty = me.clientY - _drc.top;
    //   if (tx < 0) tx = 0;
    //   if (ty < 0) ty = 0;

    //   fn_setSize(_trsf, 50, 50, tx, ty);


    //   fn_test();
    // });

  </script>

</body>

</html>